<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>LED 控制器</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 50px; }
    button { font-size: 22px; padding: 15px 30px; margin: 10px; border-radius: 8px; }
    #on { background: #4CAF50; color: white; }
    #off { background: #f44336; color: white; }
  </style>
</head>
<body>
  <h2>BLE 控制板载 LED</h2>
  <button onclick="connect()">连接设备</button><br><br>
  <button id="on" onclick="sendCommand('ON')">开启</button>
  <button id="off" onclick="sendCommand('OFF')">关闭</button>

  <script>
    let characteristic = null;

    async function connect() {
      try {
        const device = await navigator.bluetooth.requestDevice({
          filters: [{ name: 'A1-FFFF1222A999' }],
          optionalServices: [0xFFF0]
        });
        const server = await device.gatt.connect();
        const service = await server.getPrimaryService(0xFFF0);
        characteristic = await service.getCharacteristic(0xFFF1);
        alert("连接成功！");
      } catch (e) {
        alert("连接失败：" + e);
      }
    }

    async function sendCommand(cmd) {
      if (!characteristic) {
        alert("请先连接设备！");
        return;
      }
      await characteristic.writeValue(new TextEncoder().encode(cmd));
    }
  </script>
</body>
</html>
